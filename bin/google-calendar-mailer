#!/usr/bin/env node
const gcm = require('../lib/google-calendar-mailer')

let taskFile = process.argv[2]

if (!taskFile) {
  gcm.errorExitWithMessage('Usage: google-calendar-mailer <taskfile>')
}

taskFile = require('path').resolve(process.cwd(), taskFile)
try {
  taskFile = require(taskFile)
} catch (e) {
  gcm.errorExitWithMessage(`Unable to find or parse file: ${taskFile}`)
}

try {
  gcm.initialize(taskFile.settings, taskFile.tasks)
} catch (e) {
  gcm.errorExitWithMessage(`Unable to process configuration: ${e.message}`)
}
